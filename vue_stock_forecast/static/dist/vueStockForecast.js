!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";r.r(e);var o=r(1),n=r.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return o[t]}))}(a);e.default=n.a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{searchProducts:{type:Function,required:!0},searchProductCategories:{type:Function,required:!0},searchStockLocations:{type:Function,required:!0},searchSuppliers:{type:Function,required:!0},onFilterChange:{type:Function,required:!0},translate:{type:Function,required:!0}},data:function(){return{dateFrom:"",dateTo:"",dateGroupBy:"month",rowGroupBy:"product",locations:[],productCategories:[],products:[],suppliers:[],rows:[],visible:!0}},computed:{effectiveDateFrom:function(){return this.dateFrom||new Date},effectiveDateTo:function(){return this.dateTo||moment(new Date).add(6,this.dateGroupBy).toDate()},dateGroupByOptions:function(){return[{value:"day",label:this.translate("Day")},{value:"week",label:this.translate("Week")},{value:"month",label:this.translate("Month")}]},rowGroupByOptions:function(){return[{value:"product",label:this.translate("Product")},{value:"category",label:this.translate("Product Category")}]}},methods:{setProducts:function(t){this.products=t.map((function(t){return{id:t[0],name:t[1]}})),this.$refs.products.setItems(t)},setProductCategories:function(t){this.categories=t.map((function(t){return{id:t[0],name:t[1]}})),this.$refs.categories.setItems(t)},setLocations:function(t){this.locations=t.map((function(t){return{id:t[0],name:t[1]}})),this.$refs.locations.setItems(t)},onRowGroupByChange:function(t){this.onFilterChange()},onProductChange:function(t){this.products=t,this.onFilterChange()},onProductCategoryChange:function(t){this.productCategories=t,this.onFilterChange()},onSupplierChange:function(t){this.suppliers=t,this.onFilterChange()},onLocationChange:function(t){this.locations=t,this.onFilterChange()}}}},function(t,e,r){"use strict";r.r(e);var o=r(3),n=r.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return o[t]}))}(a);e.default=n.a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{dateFrom:{type:Date,required:!0},dateTo:{type:Date,required:!0},dateGroupBy:{type:String,required:!0},rowGroupBy:{type:String,required:!0},rows:{type:Array,required:!0},translate:{type:Function,required:!0},firstColumnFixed:{type:Boolean,default:!0}},computed:{dateGroups:function(){return function(t,e,r){var n=[],a=moment(t),i=moment(e);for(;a<i;)a.endOf(r),n.push({key:o++,date:a.format("YYYY-MM-DD")}),a.add(1,r);return n}(this.dateFrom,this.dateTo,this.dateGroupBy||"month")},rowGroupLabel:function(){var t="product"===this.rowGroupBy?"Product":"Product Category";return this.translate(t)}},methods:{productHasMovesAtDate:function(t,e){var r=moment(e).subtract(1,this.dateGroupBy||"month").format("YYYY-MM-DD");function o(t){return r<t.date&&t.date<=e}return t.incoming.filter(o).length>0||t.outgoing.filter(o).length>0},getStockValue:function(t,e){var r=function(t,e){return t+e.qty},o=function(t){return t.date<=e},a=t.incoming.filter(o).reduce(r,0),i=t.outgoing.filter(o).reduce(r,0),u=t.currentStock+a-i,s=moment(e).subtract(1,this.dateGroupBy).format("YYYY-MM-DD");function c(t){return s<t.date&&t.date<=e}var l=t.incoming.filter(c).reduce(r,0),d=t.outgoing.filter(c).reduce(r,0);return l&&d?n(u)+" (+"+n(l)+" / -"+n(d)+")":l?n(u)+" (+"+n(l)+")":d?n(u)+" (-"+n(d)+")":n(u)},displayCurrentStock:function(t){return n(t.currentStock)},displayReservedStock:function(t){return n(t.reserved)},displayAvailableStock:function(t){return n(t.currentStock-t.reserved)},currentStockClicked:function(t){this.$emit("current-stock-clicked",t)},moveAmountClicked:function(t,e){var r=moment(e).subtract(1,this.dateGroupBy).add(1,"day").format("YYYY-MM-DD");this.$emit("move-amount-clicked",t,r,e)}}};var o=1;function n(t){return t?t.toFixed(2).replace(" ","Â "):"0"}},function(t,e,r){"use strict";function o(t,e,r,o,n,a,i,u){var s,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=r,c._compiled=!0),o&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),i?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=s):n&&(s=u?function(){n.call(this,this.$root.$options.shadowRoot)}:n),s)if(c.functional){c._injectStyles=s;var l=c.render;c.render=function(t,e){return s.call(e),l(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,s):[s]}return{exports:t,options:c}}r.d(e,"a",(function(){return o}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return n}));var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"stock-forecast-report"},[r("el-card",{staticClass:"stock-forecast-report__filters"},[r("el-form",{attrs:{model:t.$data,"label-width":"150px","label-position":"left",inline:""}},[r("el-form-item",{attrs:{label:t.translate("Location")}},[r("many2many",{ref:"locations",attrs:{search:t.searchStockLocations},on:{change:t.onLocationChange}})],1),t._v(" "),r("el-form-item",{attrs:{label:t.translate("Supplier")}},[r("many2many",{ref:"suppliers",attrs:{search:t.searchSuppliers},on:{change:t.onSupplierChange}})],1)],1),t._v(" "),r("el-form",{attrs:{model:t.$data,"label-width":"150px","label-position":"left",inline:""}},[r("el-form-item",{attrs:{label:t.translate("Rows")}},[r("el-select",{on:{change:t.onRowGroupByChange},model:{value:t.rowGroupBy,callback:function(e){t.rowGroupBy=e},expression:"rowGroupBy"}},t._l(t.rowGroupByOptions,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})))],1),t._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"product"===t.rowGroupBy,expression:"rowGroupBy === 'product'"}],attrs:{label:t.translate("Products")}},[r("many2many",{ref:"products",attrs:{search:t.searchProducts},on:{change:t.onProductChange}})],1),t._v(" "),r("el-form-item",{attrs:{label:t.translate("Product Categories")}},[r("many2many",{ref:"categories",attrs:{search:t.searchProductCategories},on:{change:t.onProductCategoryChange}})],1)],1),t._v(" "),r("el-form",{attrs:{model:t.$data,"label-width":"150px","label-position":"left",inline:""}},[r("el-form-item",{attrs:{label:t.translate("Columns")}},[r("el-select",{model:{value:t.dateGroupBy,callback:function(e){t.dateGroupBy=e},expression:"dateGroupBy"}},t._l(t.dateGroupByOptions,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})))],1),t._v(" "),r("el-form-item",{attrs:{label:t.translate("Start Date")}},[r("el-date-picker",{attrs:{type:"date"},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}})],1),t._v(" "),r("el-form-item",{attrs:{label:t.translate("End Date")}},[r("el-date-picker",{attrs:{type:"date"},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1)],1)],1),t._v(" "),r("stock-forecast-table",{attrs:{dateFrom:t.effectiveDateFrom,dateTo:t.effectiveDateTo,dateGroupBy:t.dateGroupBy,rowGroupBy:t.rowGroupBy,rows:t.rows,translate:t.translate},on:{"current-stock-clicked":function(e){return t.$emit("current-stock-clicked",e)},"move-amount-clicked":function(e,r,o){return t.$emit("move-amount-clicked",e,r,o)}}})],1)},n=[];o._withStripped=!0},function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return n}));var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"stock-forecast-table"},[r("el-table",{attrs:{data:t.rows,height:"800",border:""}},[r("el-table-column",{attrs:{label:t.rowGroupLabel,width:"300",fixed:t.firstColumnFixed},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",[t._v("\n          "+t._s(e.row.label)+"\n        ")])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:t.translate("Stock"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.currentStock?r("div",{staticClass:"stock-forecast-table__link",on:{click:function(r){t.currentStockClicked(e.row)}}},[t._v("\n          "+t._s(t.displayCurrentStock(e.row))+"\n        ")]):r("div",[t._v("0")])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:t.translate("Reserved"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",[t._v("\n          "+t._s(t.displayReservedStock(e.row))+"\n        ")])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:t.translate("Available"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",[t._v("\n          "+t._s(t.displayAvailableStock(e.row))+"\n        ")])]}}])}),t._v(" "),t._l(t.dateGroups,(function(e){return r("el-table-column",{key:e.key,attrs:{label:e.date,width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(o){return[t.productHasMovesAtDate(o.row,e.date)?r("div",{staticClass:"stock-forecast-table__link stock-forecast-table__amount",on:{click:function(r){t.moveAmountClicked(o.row,e.date)}}},[t._v("\n          "+t._s(t.getStockValue(o.row,e.date))+"\n        ")]):r("div",[t._v(t._s(t.getStockValue(o.row,e.date)))])]}}])})}))],2)],1)},n=[];o._withStripped=!0},function(t,e,r){t.exports=r(8)},function(t,e,r){"use strict";var o=a(r(9)),n=a(r(10));function a(t){return t&&t.__esModule?t:{default:t}}Vue.component("stock-forecast-report",o.default),Vue.component("stock-forecast-table",n.default),window.vueStockForecast={StockForecastReport:o.default,StockForecastTable:n.default}},function(t,e,r){"use strict";r.r(e);var o=r(5),n=r(0);for(var a in n)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(a);var i=r(4),u=Object(i.a)(n.default,o.a,o.b,!1,null,null,null);u.options.__file="src/js/StockForecastReport.vue",e.default=u.exports},function(t,e,r){"use strict";r.r(e);var o=r(6),n=r(2);for(var a in n)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(a);var i=r(4),u=Object(i.a)(n.default,o.a,o.b,!1,null,null,null);u.options.__file="src/js/StockForecastTable.vue",e.default=u.exports}]);